{% extends 'registro/base.html' %}
{% load static %}

{% block title %}Dashboard - Sistema de Registro{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/style_dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-card">
        <h2 class="dashboard-title">
            Bem-vindo, {{ user.first_name|default:user.username }}!
        </h2>

        {% if funcionario %}
            <div class="info-section">
                <div class="section-header">
                    <h3 class="section-title">Informa√ß√µes do Funcion√°rio</h3>
                </div>
                <div class="section-content">
                    <div class="info-grid">
                        <div class="info-item">
                            <p class="info-label">Nome</p>
                            <p class="info-value">{{ funcionario.nome }}</p>
                        </div>
                        
                        <div class="info-item">
                            <p class="info-label">CPF</p>
                            <p class="info-value">{{ funcionario.cpf }}</p>
                        </div>
                        
                        <div class="info-item">
                            <p class="info-label">N√≠vel de Acesso</p>
                            <p class="info-value">
                            {% if funcionario.nivel_acesso == 1 %}
                                üü¢ N√≠vel 1: Geral
                                
                            {% elif funcionario.nivel_acesso == 2 %}
                                üü° N√≠vel 2: Diretor
                                
                            {% elif funcionario.nivel_acesso == 3 %}
                                üî¥ N√≠vel 3: Ministro
                                
                            {% endif %}
                        </p>
                        </div>
                        
                        <div class="info-item">
                            <p class="info-label">Divis√£o</p>
                            <p class="info-value">{{ funcionario.divisao|default:"N√£o informado" }}</p>
                        </div>
                        <div class="info-item">
                            <p class="info-label">MB da imagem</p>
                            <p class="info-value">
                                {% if mb_image %}
                                    {{ mb_image }} MB
                                {% else %}
                                    Nenhuma imagem cadastrada
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if face_data and face_data.image %}
            <div class="facial-data-section">
                <div class="section-header">
                    <h3 class="section-title">Dados de Reconhecimento Facial</h3>
                </div>
                <div class="section-content">
                    <div class="facial-data-content">
                        <img src="{{ face_data.image.url }}" alt="Foto de {{ funcionario.nome }}" class="facial-data-img">
                        <div class="facial-data-details">
                            <p class="info-label">N√∫meros do Algoritmo (Encoding)</p>
                            <p class="encoding-block">
                                {{ face_data.encoding }}
                            </p>
                        </div>
                    </div>

                <div class="dashboard-alert">
                    {# √çcone de informa√ß√£o #}
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                    <p>Voc√™ est√° logado no sistema de reconhecimento facial do Minist√©rio do Meio Ambiente.</p>
                </div>
                </div>
            </div>
        {% else %}
            <p class="alert alert-info">Nenhum dado de reconhecimento facial encontrado para este usu√°rio.</p>
        {% endif %}

        <div class="logout-group">
            {% if funcionario.nivel_acesso == 3 %}
                {# Bot√£o de a√ß√£o para administradores, ao lado do logout #}
                <a href="{% url 'cadastro' %}" class="btn btn-success">Cadastrar Funcion√°rio</a>
            {% endif %}
            <a href="{% url 'logout' %}" class="btn btn-secondary logout-btn">

                Fazer Logout
            </a>
        </div>
    </div>
</div>
{% endblock %}
